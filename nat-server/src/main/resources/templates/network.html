<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>内网穿透</title>
    <link rel="stylesheet" th:href="@{layui/css/layui.css}">
</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
    <div th:include="include/header :: header"></div>
    <div th:include="include/side :: side"></div>
    <div th:include="include/footer :: footer"></div>

    <div class="layui-body">
        <table id="table" lay-filter="table"></table>
    </div>

    <div id="modal" style="display: none;">
        <div style="width: 500px; margin: 0 auto; padding: 20px;">
            <form class="layui-form layui-form-pane" autocomplete="off">
                <div class="layui-form-item">
                    <label class="layui-form-label layui-icon layui-icon-username">内网地址</label>
                    <div class="layui-input-block">
                        <input type="text" name="name" id="name" placeholder="请输入名称" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label layui-icon layui-icon-username">描述</label>
                    <div class="layui-input-block">
                        <input type="text" name="description" id="description" placeholder="请输入描述" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label layui-icon layui-icon-username">价格</label>
                    <div class="layui-input-block">
                        <input type="text" name="price" id="price" placeholder="请输入价格" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label layui-icon layui-icon-username">状态</label>
                    <div class="layui-input-block">
                        <input type="checkbox" name="enable" value="1" lay-skin="switch" lay-text="正常|停止"
                               lay-filter="switch">
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button class="layui-btn" lay-submit lay-filter="confirm">立即提交</button>
                        <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<script type="text/html" id="toolbarTpl">
    <input class="text" style="height:30px;width:200px;" name="" id="keyword" placeholder="请输入关键词">
    <a href="javascript:void(0);" id="search">
        <i class="layui-icon layui-icon-search"></i>
    </a>
</script>
<script type="text/html" id="switchTpl">
    <input type="checkbox" name="enable" value="1" lay-skin="switch" lay-text="正常|停止" lay-filter="switch"
           {{ d.enable== 1 ? 'checked' : '' }}>
</script>
<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="app">密钥</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
<script th:src="@{layui/layui.js}"></script>
<script th:inline="none">
    layui.use(['element', 'jquery', 'table', 'form'], function () {
        var element = layui.element, $ = layui.jquery, table = layui.table, form = layui.form;

        // $('body').on('click', '#search', function () {
        //     table.reload('table', {
        //         url: 'seller/order/list',
        //         page: true,
        //         where: {keyword: $('#keyword').val()}
        //     });
        // });

        table.render({
            elem: '#table',
            // url: '',
            toolbar: '#toolbarTpl', // 'default'
            defaultToolbar: [{
                title: '添加',
                layEvent: 'add',
                icon: 'layui-icon-add-1'
            }, 'filter', 'exports', 'print'],
            page: true,
            data: [{
                "id": "10000",
                "ip": "192.168.0.1",
                "port": "1234",
                "remote": "10000",
                "content": "小程序接口",
                "number": "2",
                "enable": 0,
                "secret": 'abcedfg'
            }, {
                "id": "10001",
                "ip": "192.168.0.2",
                "port": "5678",
                "remote": "10001",
                "content": "支付接口",
                "number": "3",
                "enable": 1,
                "secret": 'abcedfg'
            }],
            title: '用户数据表',
            cols: [[
                {field: 'id', title: 'ID', width: 100, sort: true},
                {field: 'ip', title: '内网地址'},
                {field: 'port', title: '内网端口'},
                {field: 'remote', title: '公网端口'},
                {field: 'content', title: '备注'},
                {field: 'number', title: '连接数'},
                {field: 'enable', title: '状态', width: 100, templet: '#switchTpl'},
                {fixed: 'right', title: '操作', width: 120, toolbar: '#barDemo',}
            ]]
        });

        // 监听头工具栏事件
        table.on('toolbar(table)', function (obj) {
            if (obj.event === 'add') {
                layer.open({
                    type: 1, // 0：信息框，默认 1：页面层 2：iframe层 3：加载层 4：tips层
                    title: '添加商品',
                    content: $('#modal'),
                    area: ['800px', '600px'],
                    shadeClose: true,
                    end: function () {
                        $('form')[0].reset();
                    }
                });
            }
        });

        //监听行工具事件
        table.on('tool(table)', function (obj) {
            var data = obj.data;
            if (obj.event === 'app') {
                layer.open({
                    type: 1,
                    title: '密钥',
                    area: ['200px', '150px'],
                    content: '<div style="text-align: center; margin-top: 20px">' + data.secret + '</div>',
                    btn: '关闭',
                    btnAlign: 'c',
                    shade: 0,
                    yes: function () {
                        layer.closeAll();
                    }
                });
            } else if (obj.event === 'del') {
                layer.confirm('真的删除行么', function (index) {
                    obj.del();
                    layer.close(index);
                });
            }
        });

        //监听状态操作
        form.on('switch(enable)', function (obj) {
            layer.tips(this.value + ' ' + this.name + '：' + obj.elem.checked, obj.othis);
        });
    });
</script>
</body>
</html>